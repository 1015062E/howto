<br>
<table>
<td>WARNING</td>
<td>Please refer to this document with an understanding of the potential risks involved. Proceed at your own discretion.</td>
</table>
<br>

# Monitoring Working Set Sizes for Processes in PowerShell

In this blog post, we'll walk through a PowerShell script to monitor the working set sizes for processes. This script is particularly useful for tracking memory usage of specific processes, such as `msmdsrv.exe`. Note: This content is generated by AI.

## Prerequisites

- Ensure you run PowerShell as an administrator to have the necessary permissions to access process information.

## Script Overview

The script retrieves the minimum, current, and maximum working set sizes for all instances of a specified process. It also includes the path of the executable file for each process.

## PowerShell Script

Here's the PowerShell script:

```powershell
# Define the process name as a variable
$processName = "msmdsrv"

# Get all processes with the specified name
$processes = Get-Process -Name $processName

# Create an array to store the process information
$processInfo = @()

foreach ($process in $processes) {
    $minWorkingSet = $process.MinWorkingSet
    $maxWorkingSet = $process.MaxWorkingSet
    $currentWorkingSet = $process.WorkingSet64
    $exePath = $process.MainModule.FileName

    # Add the process information to the array
    $processInfo += [PSCustomObject]@{
        'Process Name'        = $process.ProcessName
        'Process ID'          = $process.Id
        'Minimum Working Set' = "$minWorkingSet bytes"
        'Current Working Set' = "$currentWorkingSet bytes"
        'Maximum Working Set' = "$maxWorkingSet bytes"
        'Executable Path'     = $exePath
    }
}

# Output the process information as a table
$processInfo | Format-Table -AutoSize
```

## How to Use the Script

1. Open PowerShell as an administrator.
2. Copy and paste the script into your PowerShell window.
3. Press `Enter` to run the script.

The script will output a table with the following columns:
- Process Name
- Process ID
- Minimum Working Set
- Current Working Set
- Maximum Working Set
- Executable Path

## Example Output

```
Process Name Process ID Minimum Working Set Current Working Set Maximum Working Set Executable Path
------------ ---------- ------------------- ------------------- ------------------- ---------------
msmdsrv            9084 6871851008 bytes    555397120 bytes     30923337728 bytes   C:\Program Files\Microsoft Power BI Desktop\bin\msmdsrv.exe
msmdsrv           10944 6871851008 bytes    522825728 bytes     30923337728 bytes   C:\Program Files\Microsoft Power BI Desktop RS\bin\msmdsrv.exe
msmdsrv           24572 6871851008 bytes    175267840 bytes     30923337728 bytes   C:\Program Files\Microsoft SQL Server\MSAS16.MSSQLSERVER\OLAP\bin\msmdsrv.exe
```

Feel free to customize the `$processName` variable at the top of the script to monitor different processes.

## Conclusion

This script provides a straightforward way to monitor the working set sizes of processes in PowerShell. By running the script as an administrator, you can ensure you have the necessary permissions to access all process information.

Happy scripting!
